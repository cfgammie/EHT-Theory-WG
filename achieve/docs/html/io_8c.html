<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>ACHIEVE: io.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ACHIEVE
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('io_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">io.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Subroutines to perform I/O with FITS, OIFITS, etc. files.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;math.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;unistd.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &quot;fitsio.h&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a8d23feea868a983c8c2b661e1e16972f"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a8d23feea868a983c8c2b661e1e16972f"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#a8d23feea868a983c8c2b661e1e16972f">RED</a>&#160;&#160;&#160;&quot;\x1B[31m&quot;</td></tr>
<tr class="memdesc:a8d23feea868a983c8c2b661e1e16972f"><td class="mdescLeft">&#160;</td><td class="mdescRight">color RED for error output <br /></td></tr>
<tr class="separator:a8d23feea868a983c8c2b661e1e16972f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5bc410b99375860e54cee3f4bfe4b08e"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a5bc410b99375860e54cee3f4bfe4b08e"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#a5bc410b99375860e54cee3f4bfe4b08e">RESETCOLOR</a>&#160;&#160;&#160;&quot;\x1B[0m&quot;</td></tr>
<tr class="memdesc:a5bc410b99375860e54cee3f4bfe4b08e"><td class="mdescLeft">&#160;</td><td class="mdescRight">color to reset to normal <br /></td></tr>
<tr class="separator:a5bc410b99375860e54cee3f4bfe4b08e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:af8262d98b802937c574957354af572fc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#af8262d98b802937c574957354af572fc">printErrorIO</a> (char errmsg[])</td></tr>
<tr class="memdesc:af8262d98b802937c574957354af572fc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prints an error message.  <a href="#af8262d98b802937c574957354af572fc">More...</a><br /></td></tr>
<tr class="separator:af8262d98b802937c574957354af572fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9ee556f23e84209607c2940391b6fa6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#ae9ee556f23e84209607c2940391b6fa6">readFITSImagedim</a> (char fname[], int *Ny, int *Nx, double *yScale, double *xScale)</td></tr>
<tr class="memdesc:ae9ee556f23e84209607c2940391b6fa6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads the image dimensions of a FITS file, both in terms of pixels and in terms of physical units.  <a href="#ae9ee556f23e84209607c2940391b6fa6">More...</a><br /></td></tr>
<tr class="separator:ae9ee556f23e84209607c2940391b6fa6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1093cacb975cf9e6dc3845a1f65f53dd"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#a1093cacb975cf9e6dc3845a1f65f53dd">readFITSImage</a> (char fname[], int Ny, int Nx, int Npad, double *Image)</td></tr>
<tr class="memdesc:a1093cacb975cf9e6dc3845a1f65f53dd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads the image stored in a FITS file and, optionally, pads it with zeros.  <a href="#a1093cacb975cf9e6dc3845a1f65f53dd">More...</a><br /></td></tr>
<tr class="separator:a1093cacb975cf9e6dc3845a1f65f53dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0be222f95ff496610bb360e01aab56d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#ad0be222f95ff496610bb360e01aab56d">readFITSCubedim</a> (char fname[], int *Ny, int *Nx, double *yScale, double *xScale)</td></tr>
<tr class="memdesc:ad0be222f95ff496610bb360e01aab56d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads the image dimensions of a FITS data cube, both in terms of pixels and in terms of physical units.  <a href="#ad0be222f95ff496610bb360e01aab56d">More...</a><br /></td></tr>
<tr class="separator:ad0be222f95ff496610bb360e01aab56d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae14d311c7a554992bda3fcf35a0c54a0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#ae14d311c7a554992bda3fcf35a0c54a0">readFITSCube</a> (char fname[], int Ny, int Nx, double *Image)</td></tr>
<tr class="memdesc:ae14d311c7a554992bda3fcf35a0c54a0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads the image stored in a FITS data cube and, optionally, pads it with zeros.  <a href="#ae14d311c7a554992bda3fcf35a0c54a0">More...</a><br /></td></tr>
<tr class="separator:ae14d311c7a554992bda3fcf35a0c54a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab884e4759cc79d219ef42f9e6835c2b1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#ab884e4759cc79d219ef42f9e6835c2b1">writeFITSVis</a> (char fname[], int Ny, int Nx, double *Vp, double *Va, double vScale, double uScale, char hist[])</td></tr>
<tr class="memdesc:ab884e4759cc79d219ef42f9e6835c2b1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes visibility amplitudes and phases into a FITS file.  <a href="#ab884e4759cc79d219ef42f9e6835c2b1">More...</a><br /></td></tr>
<tr class="separator:ab884e4759cc79d219ef42f9e6835c2b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9403cd46eafa834291081dcb30e0a528"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#a9403cd46eafa834291081dcb30e0a528">writeFITSImage</a> (char fname[], int Npixel, double pixelSize, double *Image, char hist[])</td></tr>
<tr class="memdesc:a9403cd46eafa834291081dcb30e0a528"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes a model image into a FITS file.  <a href="#a9403cd46eafa834291081dcb30e0a528">More...</a><br /></td></tr>
<tr class="separator:a9403cd46eafa834291081dcb30e0a528"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c643255817d3e98ce8a002bec9d0007"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#a5c643255817d3e98ce8a002bec9d0007">indexArr</a> (int i, int j, int Ny, int Nx)</td></tr>
<tr class="memdesc:a5c643255817d3e98ce8a002bec9d0007"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to convert 2D array indices to a pointer location.  <a href="#a5c643255817d3e98ce8a002bec9d0007">More...</a><br /></td></tr>
<tr class="separator:a5c643255817d3e98ce8a002bec9d0007"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a835d3662188c934c07cb534f441241be"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#a835d3662188c934c07cb534f441241be">ArrayPad</a> (int Ny, int Nx, int Npad, int *iRowStart, int *iColStart, int *NyPad, int *NxPad)</td></tr>
<tr class="memdesc:a835d3662188c934c07cb534f441241be"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to calculate sizes and starting locations of padded images.  <a href="#a835d3662188c934c07cb534f441241be">More...</a><br /></td></tr>
<tr class="separator:a835d3662188c934c07cb534f441241be"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Subroutines to perform I/O with FITS, OIFITS, etc. files. </p>
<dl class="section author"><dt>Author</dt><dd>Dimitrios Psaltis</dd></dl>
<dl class="section version"><dt>Version</dt><dd>1.0</dd></dl>
<dl class="section date"><dt>Date</dt><dd>October 2, 2017</dd></dl>
<dl class="bug"><dt><b><a class="el" href="bug.html#_bug000013">Bug:</a></b></dt><dd>No known bugs</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>No known warnings</dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000013">Todo:</a></b></dt><dd>nothing left</dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a835d3662188c934c07cb534f441241be"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ArrayPad </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Ny</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Nx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Npad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>iRowStart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>iColStart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>NyPad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>NxPad</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to calculate sizes and starting locations of padded images. </p>
<p>Given an initial size Ny*Nx of an immage array and a padding integer Npad, it returns (i) the starting row (iRowStart) and column (iColStart) of the actual image in the padded array (with the first pixel counting from [1,1]) (ii) the size of the padded array along each direction (NxPad and NyPad), which will be the larger of the initial size and Npad, along each direction</p>
<p>It returns zero if it all worked out, one if it didn't.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Ny</td><td>an int with the number of rows in the image </td></tr>
    <tr><td class="paramname">Nx</td><td>an int with the number of columns in the image </td></tr>
    <tr><td class="paramname">Npad</td><td>an int with the padding parameter </td></tr>
    <tr><td class="paramname">*iRowStart</td><td>an int pointer that returns the starting row of the image in the padded array </td></tr>
    <tr><td class="paramname">*iColStart</td><td>an int pointer that returns the starting column of the image in the padded array </td></tr>
    <tr><td class="paramname">NyPad</td><td>an int pointer that returns the number of rows of the padded image </td></tr>
    <tr><td class="paramname">NxPad</td><td>an int pointer that returns the number of columns of the padded image</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Dimitrios Psaltis</dd></dl>
<dl class="section version"><dt>Version</dt><dd>1.0</dd></dl>
<dl class="section date"><dt>Date</dt><dd>October 3, 2017</dd></dl>
<dl class="bug"><dt><b><a class="el" href="bug.html#_bug000021">Bug:</a></b></dt><dd>No known bugs</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>it assumes that all integers are positive, so it never returns anything but zero</dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000021">Todo:</a></b></dt><dd>nothing left</dd></dl>

</div>
</div>
<a class="anchor" id="a5c643255817d3e98ce8a002bec9d0007"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int indexArr </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Ny</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Nx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to convert 2D array indices to a pointer location. </p>
<p>Given an [Ny][Nx] array, it takes the two coordinates i and j of an element and converts it to an incremental pointer location. The i- and j- coordinates start from (1,1) for the first point</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">i</td><td>an int with the row coordinate of an element </td></tr>
    <tr><td class="paramname">j</td><td>an int with the column coordinate of an element </td></tr>
    <tr><td class="paramname">Ny</td><td>an int with the number of rows in the image (not used) </td></tr>
    <tr><td class="paramname">Nx</td><td>an int with the number of columns in the image</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Dimitrios Psaltis</dd></dl>
<dl class="section version"><dt>Version</dt><dd>1.0</dd></dl>
<dl class="section date"><dt>Date</dt><dd>October 3, 2017</dd></dl>
<dl class="bug"><dt><b><a class="el" href="bug.html#_bug000020">Bug:</a></b></dt><dd>No known bugs</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>No known warnings</dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000020">Todo:</a></b></dt><dd>nothing left</dd></dl>

</div>
</div>
<a class="anchor" id="af8262d98b802937c574957354af572fc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void printErrorIO </td>
          <td>(</td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>errmsg</em>[]</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Prints an error message. </p>
<dl class="section author"><dt>Author</dt><dd>Dimitrios Psaltis</dd></dl>
<dl class="section version"><dt>Version</dt><dd>1.0</dd></dl>
<dl class="section date"><dt>Date</dt><dd>September 30, 2017</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">errmsg[]</td><td>a string with the error message to be printed</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>nothing </dd></dl>

</div>
</div>
<a class="anchor" id="ae14d311c7a554992bda3fcf35a0c54a0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int readFITSCube </td>
          <td>(</td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>fname</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Ny</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Nx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>Image</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads the image stored in a FITS data cube and, optionally, pads it with zeros. </p>
<p>Reads the image stored in the FITS file 'fname', with known dimensions Nx and Ny [to be obtained using readFITSdim()]. If Npad is larger than Nx or Ny, then it pads the image so that the corresponding dimension has Npad grid points.</p>
<p>The difference with readFITSImage is that this subroutine reads in a 4D cube. It only works with FITS files that have a dimension of 4, and assumes that the first two directions are the actual image axes.</p>
<p>It returns zero if everything was OK or the FITS error code (and prints an error message) if it wasn't.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fname[]</td><td>a string with the filename to be read </td></tr>
    <tr><td class="paramname">Nx</td><td>an int with the dimension of the "x-axis" </td></tr>
    <tr><td class="paramname">Ny</td><td>an int with the dimension of the "y-axis"</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Dimitrios Psaltis</dd></dl>
<dl class="section version"><dt>Version</dt><dd>1.0</dd></dl>
<dl class="section date"><dt>Date</dt><dd>July 30, 2018</dd></dl>
<dl class="bug"><dt><b><a class="el" href="bug.html#_bug000017">Bug:</a></b></dt><dd>No known bugs</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>No known warnings</dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000017">Todo:</a></b></dt><dd>nothing left</dd></dl>

</div>
</div>
<a class="anchor" id="ad0be222f95ff496610bb360e01aab56d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int readFITSCubedim </td>
          <td>(</td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>fname</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>Ny</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>Nx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>yScale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>xScale</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads the image dimensions of a FITS data cube, both in terms of pixels and in terms of physical units. </p>
<p>Reads the image dimensions of the FITS file given in the argument fname. It returns the dimensions of the image (in pixels) along its two axes in Nx and Ny and the size of each pixel along the two axis in xScale and yScale.</p>
<p>The difference with readFITSImageDim is that this subroutine reads in a 4D cube. It only works with FITS files that have a dimension of 4, and assumes that the first two directions are the actual image axes.</p>
<p>In this and in other subroutines, the x-axis is the same as the columns and the y-axis is the same as the rows of the image. These two notations will be used interchangeably.</p>
<p>It returns zero if everything was OK or the FITS error code (and prints an error message) if it wasn't.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fname[]</td><td>a string with the filename to be read </td></tr>
    <tr><td class="paramname">*Ny</td><td>on return, an int pointer with the dimension of the "y-axis" (# of rows) </td></tr>
    <tr><td class="paramname">*Nx</td><td>on return, an int pointer with the dimension of the "x-axis" (# of columns) </td></tr>
    <tr><td class="paramname">*yScale</td><td>on return, a double pointer with the physical size of a pixel along the y-axis </td></tr>
    <tr><td class="paramname">*xScale</td><td>on return, a double pointer with the physical size of a pixel along the x-axis</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Dimitrios Psaltis</dd></dl>
<dl class="section version"><dt>Version</dt><dd>1.0</dd></dl>
<dl class="section date"><dt>Date</dt><dd>July 30, 2018</dd></dl>
<dl class="bug"><dt><b><a class="el" href="bug.html#_bug000016">Bug:</a></b></dt><dd>No known bugs</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>No known warnings</dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000016">Todo:</a></b></dt><dd>nothing left</dd></dl>

</div>
</div>
<a class="anchor" id="a1093cacb975cf9e6dc3845a1f65f53dd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int readFITSImage </td>
          <td>(</td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>fname</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Ny</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Nx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Npad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>Image</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads the image stored in a FITS file and, optionally, pads it with zeros. </p>
<p>Reads the image stored in the FITS file 'fname', with known dimensions Nx and Ny [to be obtained using readFITSdim()]. If Npad is larger than Nx or Ny, then it pads the image so that the corresponding dimension has Npad grid points.</p>
<p>It returns zero if everything was OK or the FITS error code (and prints an error message) if it wasn't.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fname[]</td><td>a string with the filename to be read </td></tr>
    <tr><td class="paramname">Nx</td><td>an int with the dimension of the "x-axis" </td></tr>
    <tr><td class="paramname">Ny</td><td>an int with the dimension of the "y-axis" </td></tr>
    <tr><td class="paramname">Npad</td><td>an int with the dimension along each direction of the padded image</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Dimitrios Psaltis</dd></dl>
<dl class="section version"><dt>Version</dt><dd>1.0</dd></dl>
<dl class="section date"><dt>Date</dt><dd>October 2, 2017</dd></dl>
<dl class="bug"><dt><b><a class="el" href="bug.html#_bug000015">Bug:</a></b></dt><dd>No known bugs</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>No known warnings</dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000015">Todo:</a></b></dt><dd>nothing left</dd></dl>

</div>
</div>
<a class="anchor" id="ae9ee556f23e84209607c2940391b6fa6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int readFITSImagedim </td>
          <td>(</td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>fname</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>Ny</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>Nx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>yScale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>xScale</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads the image dimensions of a FITS file, both in terms of pixels and in terms of physical units. </p>
<p>Reads the image dimensions of the FITS file given in the argument fname. It returns the dimensions of the image (in pixels) along its two axes in Nx and Ny and the size of each pixel along the two axis in xScale and yScale.</p>
<p>In this and in other subroutines, the x-axis is the same as the columns and the y-axis is the same as the rows of the image. These two notations will be used interchangeably.</p>
<p>It returns zero if everything was OK or the FITS error code (and prints an error message) if it wasn't.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fname[]</td><td>a string with the filename to be read </td></tr>
    <tr><td class="paramname">*Ny</td><td>on return, an int pointer with the dimension of the "y-axis" (# of rows) </td></tr>
    <tr><td class="paramname">*Nx</td><td>on return, an int pointer with the dimension of the "x-axis" (# of columns) </td></tr>
    <tr><td class="paramname">*yScale</td><td>on return, a double pointer with the physical size of a pixel along the y-axis </td></tr>
    <tr><td class="paramname">*xScale</td><td>on return, a double pointer with the physical size of a pixel along the x-axis</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Dimitrios Psaltis</dd></dl>
<dl class="section version"><dt>Version</dt><dd>1.0</dd></dl>
<dl class="section date"><dt>Date</dt><dd>October 2, 2017</dd></dl>
<dl class="bug"><dt><b><a class="el" href="bug.html#_bug000014">Bug:</a></b></dt><dd>No known bugs</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>No known warnings</dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000014">Todo:</a></b></dt><dd>nothing left</dd></dl>

</div>
</div>
<a class="anchor" id="a9403cd46eafa834291081dcb30e0a528"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int writeFITSImage </td>
          <td>(</td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>fname</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Npixel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>pixelSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>Image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>hist</em>[]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Writes a model image into a FITS file. </p>
<p>Given the double array Image of dimensions Npixel by Npixel, it stores it in the FITS file 'fname'</p>
<p>It returns zero if everything was OK or the FITS error code (and prints an error message) if it wasn't.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fname[]</td><td>a string with the filename to be read </td></tr>
    <tr><td class="paramname">Npixel</td><td>an int with the number of pixels along each axis </td></tr>
    <tr><td class="paramname">pixelSize</td><td>a double with the physical size of each pixel </td></tr>
    <tr><td class="paramname">Image[]</td><td>a Npixel by Npixel double array with the image </td></tr>
    <tr><td class="paramname">hist[]</td><td>a string of characters to be put in the "history" field of the FITS file</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Dimitrios Psaltis</dd></dl>
<dl class="section version"><dt>Version</dt><dd>1.0</dd></dl>
<dl class="section date"><dt>Date</dt><dd>November 3, 2017</dd></dl>
<dl class="bug"><dt><b><a class="el" href="bug.html#_bug000019">Bug:</a></b></dt><dd>No known bugs</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>No known warnings</dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000019">Todo:</a></b></dt><dd>nothing left</dd></dl>

</div>
</div>
<a class="anchor" id="ab884e4759cc79d219ef42f9e6835c2b1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int writeFITSVis </td>
          <td>(</td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>fname</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Ny</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Nx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>Vp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>Va</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>vScale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>uScale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>hist</em>[]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Writes visibility amplitudes and phases into a FITS file. </p>
<p>Given two real arrays Va[] and Vp[] of dimensions Nx by Ny, it stores them in the FITS file 'fname'</p>
<p>It returns zero if everything was OK or the FITS error code (and prints an error message) if it wasn't.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fname[]</td><td>a string with the filename to be read </td></tr>
    <tr><td class="paramname">Nx</td><td>an int with the dimension of the "x-axis" </td></tr>
    <tr><td class="paramname">Ny</td><td>an int with the dimension of the "y-axis" </td></tr>
    <tr><td class="paramname">Va[]</td><td>is a Nx by Ny double array with the visibility amplitudes </td></tr>
    <tr><td class="paramname">Vp[]</td><td>is a Nx by Ny double array with the visibility phases (in rad) </td></tr>
    <tr><td class="paramname">uScale</td><td>is a double with the physical size of each pixel in the x-direction </td></tr>
    <tr><td class="paramname">vScale</td><td>is a double with the physical size of each pixel in the x-direction </td></tr>
    <tr><td class="paramname">hist[]</td><td>is a string of characters to be put in the "history" field of the FITS file</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Dimitrios Psaltis</dd></dl>
<dl class="section version"><dt>Version</dt><dd>1.0</dd></dl>
<dl class="section date"><dt>Date</dt><dd>November 3, 2017</dd></dl>
<dl class="bug"><dt><b><a class="el" href="bug.html#_bug000018">Bug:</a></b></dt><dd>No known bugs</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>No known warnings</dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000018">Todo:</a></b></dt><dd>nothing left</dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="io_8c.html">io.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
